/*
 Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",lang:"en,zh-cn",icons:"bgcolor,textcolor",icontype:".svg",iconoffset:"center",iconbgsize:"16px",hidpi:!1,init:function(e){function t(a,f,r,l,m){var n=new CKEDITOR.style(h["colorButton_"+f+"Style"]),k=CKEDITOR.tools.getNextId()+"_colorBox",p;m=m||{};e.ui.add(a,CKEDITOR.UI_PANELBUTTON,{label:r,title:r,modes:{wysiwyg:1},editorFocus:0,toolbar:"insert,"+l,allowedContent:n,requiredContent:n,contentTransformations:m.contentTransformations,
panel:{css:CKEDITOR.skin.getPath("editor"),className:"cke_colorpicker",attributes:{role:"listbox","aria-label":g.panelTitle}},onBlock:function(a,b){p=b;b.autoSize=!0;b.element.addClass("cke_colorblock");b.element.setHtml(y(a,f,k));b.element.getDocument().getBody().setStyle("overflow","hidden");CKEDITOR.ui.fire("ready",this);var c=b.keys,d="rtl"==e.lang.dir;c[d?37:39]="next";c[40]="next";c[9]="next";c[d?39:37]="prev";c[38]="prev";c[CKEDITOR.SHIFT+9]="prev";c[32]="click"},refresh:function(){e.activeFilter.check(n)||
this.setState(CKEDITOR.TRISTATE_DISABLED)},onOpen:function(){var a=e.getSelection(),b=a&&a.getStartElement(),c=e.elementPath(b);if(c){b=c.block||c.blockLimit||e.document.getBody();do c=b&&b.getComputedStyle("back"==f?"background-color":"color")||"transparent";while("back"==f&&"transparent"==c&&b&&(b=b.getParent()));c&&"transparent"!=c||(c="#ffffff");!1!==h.colorButton_enableAutomatic&&this._.panel._.iframe.getFrameDocument().getById(k).setStyle("background-color",c);if(b=a&&a.getRanges()[0]){for(var a=
new CKEDITOR.dom.walker(b),d=b.collapsed?b.startContainer:a.next(),b="";d;){d.type===CKEDITOR.NODE_TEXT&&(d=d.getParent());d=u(d.getComputedStyle("back"==f?"background-color":"color"));b=b||d;if(b!==d){b="";break}d=a.next()}a=b;b=p._.getItems();for(d=0;d<b.count();d++){var g=b.getItem(d);g.removeAttribute("aria-selected");a&&a==u(g.getAttribute("data-value"))&&g.setAttribute("aria-selected",!0)}}return c}}})}function y(a,f,r){-1===h.colorButton_colors.indexOf("AUTO")&&(h.colorButton_colors="AUTO,"+
h.colorButton_colors);a=[];var l=h.colorButton_colors.split(","),m=h.colorButton_colorsPerRow||9,n=e.plugins.colordialog&&!1!==h.colorButton_enableMore,k=l.length+(n?2:1),p=CKEDITOR.tools.addFunction(function(a,b){function c(a){e.removeStyle(new CKEDITOR.style(h["colorButton_"+b+"Style"],{color:"inherit"}));var d=h["colorButton_"+b+"Style"];d.childRule="back"==b?function(a){return v(a)}:function(a){return!(a.is("a")||a.getElementsByTag("a").count())||v(a)};e.focus();e.applyStyle(new CKEDITOR.style(d,
{color:a}));e.fire("saveSnapshot")}e.focus();e.fire("saveSnapshot");if("?"==a)e.getColorFromDialog(function(a){if(a)return c(a)});else return c(a)});a.push('\x3ctable role\x3d"presentation" cellspacing\x3d0 cellpadding\x3d0 width\x3d"100%"\x3e');for(var q=0;q<l.length;q++)if(0===q%m&&a.push("\x3c/tr\x3e\x3ctr\x3e"),"AUTO"===l[q])a.push('\x3ctd\x3e\x3ca class\x3d"cke_colorbox cke_colorauto" _cke_focus\x3d1 hidefocus\x3dtrue title\x3d"',g.auto,'" onclick\x3d"CKEDITOR.tools.callFunction(',p,",null,'",
f,"');return false;\" href\x3d\"javascript:void('",g.auto,'\')" role\x3d"option" aria-posinset\x3d"1" aria-setsize\x3d"',k,'"\x3e\x3cspan class\x3d"cke_colorbox" style\x3d"background-color:#ffffff" id\x3d"',r,'"\x3e\x3c/span\x3e\x3c/a\x3e\x3c/td\x3e');else{var b=l[q].split("/"),c=b[0],d=b[1]||c;b[1]||(c="#"+c.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3"));a.push('\x3ctd\x3e\x3ca class\x3d"cke_colorbox" _cke_focus\x3d1 hidefocus\x3dtrue title\x3d"" onclick\x3d"CKEDITOR.tools.callFunction(',p,",'",c,"','",
f,"'); return false;\" href\x3d\"javascript:void('",e.lang.colorbutton.colors[d]||d,'\')" data-value\x3d"'+d+'" role\x3d"option" aria-posinset\x3d"',q+2,'" aria-setsize\x3d"',k,'"\x3e\x3cspan class\x3d"cke_colorbox" style\x3d"background-color:#',d,'"\x3e\x3c/span\x3e\x3c/a\x3e\x3c/td\x3e')}n&&a.push('\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"'+m+'" align\x3d"center"\x3e\x3ca class\x3d"cke_colormore" _cke_focus\x3d1 hidefocus\x3dtrue title\x3d"',g.more,'" onclick\x3d"CKEDITOR.tools.callFunction(',p,
",'?','",f,"');return false;\" href\x3d\"javascript:void('",g.more,"')\"",' role\x3d"option" aria-posinset\x3d"',k,'" aria-setsize\x3d"',k,'"\x3e',g.more,"\x3c/a\x3e\x3c/td\x3e");a.push("\x3c/tr\x3e\x3c/table\x3e");return a.join("")}function v(a){return"false"==a.getAttribute("contentEditable")||a.getAttribute("data-nostyle")}function u(a){return CKEDITOR.tools.normalizeHex("#"+CKEDITOR.tools.convertRgbToHex(a||"")).replace(/#/g,"")}var h=e.config,g=e.lang.colorbutton;if(!CKEDITOR.env.hc){t("TextColor",
"fore",g.textColorTitle,9,{contentTransformations:[[{element:"font",check:"span{color}",left:function(a){return!!a.attributes.color},right:function(a){a.name="span";a.attributes.color&&(a.styles.color=a.attributes.color);delete a.attributes.color}}]]});var w={},x=e.config.colorButton_normalizeBackground;if(void 0===x||x)w.contentTransformations=[[{element:"span",left:function(a){var e=CKEDITOR.tools;if("span"!=a.name||!a.styles||!a.styles.background)return!1;a=e.style.parse.background(a.styles.background);
return a.color&&1===e.objectKeys(a).length},right:function(a){var f=(new CKEDITOR.style(e.config.colorButton_backStyle,{color:a.styles.background})).getDefinition();a.name=f.element;a.styles=f.styles;a.attributes=f.attributes||{};return a}}]];t("BGColor","back",g.bgColorTitle,20,w)}}});CKEDITOR.config.colorButton_colors="AUTO,0D0016,FE2C24,FF9900,FFD900,A2E043,38D8F0,4DA8EE,956FE7,F3F3F4,CCCCCC,FEF2F0,FFF5E6,FEFCD8,EDF6E8,E7FAFA,EAF4FC,EFEDF6,D7D8D9,A5A5A5,FBD4D0,FFD7B9,F9EDA6,D4E9D5,C7E6EA,CBE0F1,DAD5E9,7B7F82,494949,ED7976,FAA572,E6B223,98C091,79C6CD,6EAAD7,9C8EC1,9C8EC1,333333,BE191C,B95514,AD720D,1C7331,1C7892,1A439C,511B78";
CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]};CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};