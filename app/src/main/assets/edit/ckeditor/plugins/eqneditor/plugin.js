CKEDITOR.plugins.add("eqneditor",{availableLangs:{en:1},lang:"en",requires:["dialog"],icons:"eqneditor",icontype:".svg",iconoffset:"center",iconbgsize:"16px",hidpi:!1,init:function(a){CKEDITOR.scriptLoader.load([this.path+"libs/eq_config.js",this.path+"libs/eq_editor-lite-19.js"]);var d=document.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",this.path+"libs/equation-embed.css");document.getElementsByTagName("head")[0].appendChild(d);
a.addCommand("eqneditorDialog",new CKEDITOR.dialogCommand("eqneditorDialog",{allowedContent:"img[src,alt]",requiredContent:"img[src,alt]"}));CKEDITOR.dialog.add("eqneditorDialog",this.path+"dialogs/eqneditor.js");a.ui.addButton("EqnEditor",{label:a.lang.eqneditor.toolbar,command:"eqneditorDialog",toolbar:"insert,15"});a.contextMenu&&(a.addMenuGroup(a.lang.eqneditor.menu),a.addMenuItem("eqneditor",{label:a.lang.eqneditor.edit,command:"eqneditorDialog",group:a.lang.eqneditor.menu}),a.contextMenu.addListener(function(a){var b=
{};if(a.getAscendant("img",!0)&&null!=a.getAttribute("src").match(/(gif|svg)\.latex\?(.*)/))return b.eqneditor=CKEDITOR.TRISTATE_OFF,b}));a.on("doubleclick",function(c){var b=c.data.element;if(b&&b.is("img")&&null!=b.getAttribute("src").match(/(gif|svg)\.latex\?(.*)/))return c.data.dialog="eqneditorDialog",c.cancelBubble=!0,c.returnValue=!1,a.openDialog(c.data.dialog),document.getElementById("CCequation"+window.CCounter).setAttribute("src",b.getAttribute("src")),c.stop(),!0},null,null,1)}});