CKEDITOR.dialog.add("csdnlinkDialog",function(e){return{allowedContent:"a[href,target]",title:"插入链接",minWidth:436,minHeight:100,resizable:CKEDITOR.DIALOG_RESIZE_NONE,contents:[{id:"CsdnLink",label:"CsdnLink",elements:[{type:"text",label:"插入URL：",labelLayout:"horizontal",width:"360px",id:"edp-URL",validate:CKEDITOR.dialog.validate.notEmpty("请填写URL"),setup:function(a){"csdnlink"===a.name&&a.ready&&a.data.url&&this.setValue(a.data.url)},commit:function(a){var b=this.getValue(),c=/^(http|https):\/\//;
b&&(c.test(b)||(b="http://"+b),"csdnlink"===a.name&&a.setData("url",b))}},{type:"text",label:"替换文本：",labelLayout:"horizontal",width:"360px",id:"edp-text-display",setup:function(a){"csdnlink"===a.name?this.setValue(a.data.text):this.setValue(a.getText())},commit:function(a){var b=this.getValue();"csdnlink"===a.name&&(""!==b&&null!==b?a.setData("text",b):a.setData("text",a.data.url))}}]}],onShow:function(){var a=this.getModel(),b=e.getSelection(),c=b.getStartElement(),d;c&&(d=c.getAscendant("a",!0));
d&&"a"==d.getName()||b&&a.setData("text",b.getSelectedText());this.element=a.element;this.setupContent(this.element)},onOk:function(){this.commitContent(this.element);this.element.$.dataset.ckeSavedHref&&(this.element.$.dataset.ckeSavedHref=this.element.$.href)}}});