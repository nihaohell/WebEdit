(function(){CKEDITOR.plugins.add("toc",{icons:"toc",lang:["en","zh-cn"],icontype:".svg",iconoffset:"center",iconbgsize:"16px",hidpi:!1,init:function(f){f.addCommand("insertToc",{allowedContent:"*[id,name,class]{margin-left}",exec:function(a){for(var c=a.document.$.getElementsByName("tableOfContents"),b=c.length;0<b;b--){var g=c[b-1].getAttribute("id").toString();a.document.getById(g).remove()}c=a.editable().find("h1,h2,h3,h4,h5,h6,");if(0==c.count())alert(a.lang.toc.notitles);else{b="";for(g=0;g<
c.count();g++){var d=c.getItem(g),f=parseInt(d.getName().substr(1))-1,h=new CKEDITOR.dom.text(CKEDITOR.tools.trim(d.getText()),a.document),e="";d.hasAttribute("id")?e=d.getAttribute("id").toString():(e=encodeURIComponent(h.getText()),d.setAttribute("id",e.toString()));d.setAttribute("name",e.toString());b=b+'\x3cp style\x3d"margin-left:'+40*f+'px" id\x3d"'+e.toString()+'-toc" name\x3d"tableOfContents"\x3e\x3ca target\x3d"_self" href\x3d"#'+e.toString()+'"\x3e'+h.getText().toString()+"\x3c/a\x3e\x3c/p\x3e"}a.insertHtml('\x3cp name\x3d"tableOfContents" id\x3d"main-toc"\x3e\x3cb\x3e'+
a.lang.toc.ToC+"\x3c/b\x3e\x3c/p\x3e"+b+'\x3chr id\x3d"hr-toc" name\x3d"tableOfContents"/\x3e',"unfiltered_html")}}});f.ui.addButton("toc",{label:f.lang.toc.tooltip,command:"insertToc",toolbar:"insert,36"})}})})();